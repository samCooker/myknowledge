<!DOCTYPE html>
<!-- saved from url=(0067)http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
    <meta name="description" content="List of hooks supported by the Cordova CLI. ">

    <title>
        
            
                Hooks Guide - Apache Cordova
            
        
    </title>

    <link rel="canonical" href="https://cordova.apache.org/docs/en/latest/guide/appdev/hooks/">

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="../common-files/main.css">
    <link rel="stylesheet" type="text/css" href="../common-files/syntax.css">
    <!-- Algolia Search CSS -->
    <link rel="stylesheet" href="../common-files/docsearch.min.css">

    <!-- Fonts -->
    <!-- For attribution information, see www/attributions.html -->
    <link href="../common-files/css" rel="stylesheet" type="text/css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<style type="text/css">._yddWrapper *{display:inline;text-align:left;font-size:12px;background:transparent;padding:0;margin:0;border:0;text-decoration:none}._yddWrapper div{display:block}._yddWrapper{z-index:10001;border:1px solid #b2d8f8;min-width:250px;max-width:400px;box-shadow:1px 1px 6px rgba(0,0,0,.2)}._yddContainer{color:#222;background:#fff;font-family:'Microsoft YaHei';position:relative;width:100%;height:100%;top:0;left:0}._yddTop{height:22px;line-height:22px;padding:0 4px;background-color:#e8f5fc}._yd_phonetic{font-family:'lucida sans unicode',arial,sans-serif;font-size:12px}._yd_voice_btn,._yd_voice_btn:hover{width:15px;height:15px;display:inline-block;vertical-align:middle;cursor:pointer;background:url(data:image/gif;base64,R0lGODlhDwAPAJECAP///zWh1P///wAAACH5BAEAAAIALAAAAAAPAA8AAAIrlC+hyKbbzoPxAcrsDYk7vXWSApQhRZqn1wXqgoIw+7lrY2H4FCF8P6IJCgA7)}a._yd_voice_btn:hover{opacity:.75}#_yd_close{cursor:pointer;position:absolute;top:0;right:4px;text-align:center;font-size:12pt}._yddKeyTitle{font-weight:bold}._yddMiddle{margin-bottom:10px}._ydd-tabs{color:#959595;margin:5px 0;padding:0 5px;height:18px;border-bottom:1px solid}._ydd-tab{display:block;float:left;height:18px;margin:0 5px -1px 0;padding:0 4px;line-height:18px;border:1px solid;border-bottom:0 none}._ydd-tabs,._ydd-tab{border-color:#d5e7f3;background:#fff}._ydd-trans-container{line-height:160%}._ydd-padding010{padding:0 10px}</style><script type="text/javascript" charset="utf-8" async="" src="../common-files/button.177407e7c9fd9de66268350cb0968e03.js"></script></head>

<body>

<div class="docs container">
    <!-- Page content -->
    <div class="col-md-8 col-lg-9 col-lg-offset-3 page-content-container container">
        <div class="page-content row">
            <div class="col-md-offset-1 col-md-10">

                <div id="page-toc-source">
                    <a class="fragment-anchor" id="hooks"></a><span id="hooks"></span><h1>Hooks</h1>

<a class="fragment-anchor" id="introduction"></a><span id="introduction"></span><h2>Introduction<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#introduction"><i class="glyphicon glyphicon-link"></i></a></h2>

<p>Cordova Hooks represent special scripts which could be added by application and
plugin developers or even by your own build system  to customize cordova commands.</p>

<p>Cordova hooks allow you to perform special activities around cordova commands. For example,
you may have a custom tool that checks for code formatting in your javascript file. And, you
would like to run this tool before every build. In such a case, you could use a
'before_build' hook and instruct the cordova run time to run the custom tool to be invoked
before every build.</p>

<p>Hooks might be related to your application activities such as such as <code>before_build</code>,
<code>after_build</code>, etc. Or, they might be related to the plugins of your application. For example,
hooks such as <code>before_plugin_add</code>, <code>after_plugin_add</code>, etc applies to plugin related
activities. These hooks can be associated with all plugins within your application or
be specific to only one plugin.</p>

<p>Cordova supports the following hook types:</p>

<!-- START HTML -->

<table class="hooks" width="100%">
    <colgroup><col width="20%">
    <col width="30%">
    <col width="50%">
    </colgroup><thead>
        <tr>
            <th>Hook Type</th>
            <th>Associated Cordova Commands</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <th data-col="beforeplatformadd">before_platform_add</th>
            <td data-col="code" rowspan="2"><code>cordova platform add</code></td>
            <td rowspan="2" class="description" data-col="description">To be executed before and after adding a platform.</td>
        </tr>
        <tr>
            <th data-col="afterplatformadd">after_platform_add</th>
        </tr>
        <tr>
            <th data-col="beforeplatformrm">before_platform_rm</th>
            <td data-col="code" rowspan="2"><code>cordova platform rm</code></td>
            <td rowspan="2" class="description" data-col="description">To be executed before and after removing a platform.</td>
        </tr>
        <tr>
            <th data-col="afterplatformrm">after_platform_rm</th>
        </tr>
        <tr>
            <th data-col="beforeplatformls">before_platform_ls</th>
            <td data-col="code" rowspan="2"><code>cordova platform ls</code></td>
            <td rowspan="2" class="description" data-col="description">To be executed before and after listing the installed and available platforms.</td>
        </tr>
        <tr>
            <th data-col="afterplatformls">after_platform_ls</th>
        </tr>
        <tr>
            <th data-col="beforeprepare">before_prepare</th>
            <td data-col="code" rowspan="2"><code>cordova prepare</code><br><code>cordova platform add</code><br><code>cordova build</code><br><code>cordova run</code></td>
            <td rowspan="2" data-col="description">To be executed before and after preparing your application.</td>
        </tr>
        <tr>
            <th data-col="afterprepare">after_prepare</th>
        </tr>
        <tr>
            <th data-col="beforecompile">before_compile</th>
            <td data-col="code" rowspan="2"><code>cordova compile</code><br><code>cordova build</code></td>
            <td rowspan="2" data-col="description">To be executed before and after compiling your application.</td>
        </tr>
        <tr>
            <th data-col="aftercompile">after_compile</th>
        </tr>
        <tr>
            <th data-col="beforebuild">before_build</th>
            <td data-col="code" rowspan="2"><code>cordova build</code></td>
            <td rowspan="2" data-col="description">To be executed before and after building your application.</td>
        </tr>
        <tr>
            <th data-col="afterbuild">after_build</th>
        </tr>
        <tr>
            <th data-col="beforeemulate">before_emulate</th>
            <td data-col="code" rowspan="2"><code>cordova emulate</code></td>
            <td rowspan="2" data-col="description">To be executed before and after emulating your application.</td>
        </tr>
        <tr>
            <th data-col="afteremulate">after_emulate</th>
        </tr>
        <tr>
            <th data-col="beforerun">before_run</th>
            <td data-col="code" rowspan="2"><code>cordova run</code></td>
            <td rowspan="2" data-col="description">To be executed before and after running your application.</td>
        </tr>
        <tr>
            <th data-col="afterrun">after_run</th>
        </tr>
        <tr>
            <th data-col="beforeserve">before_serve</th>
            <td data-col="code" rowspan="2"><code>cordova serve</code></td>
            <td rowspan="2" data-col="description">To be executed before and after serving your application.</td>
        </tr>
        <tr>
            <th data-col="afterserve">after_serve</th>
        </tr>
        <tr>
            <th data-col="beforeclean">before_clean</th>
            <td data-col="code" rowspan="2"><code>cordova clean</code></td>
            <td rowspan="2" data-col="description">To be executed before and after cleaning your application.</td>
        </tr>
        <tr>
            <th data-col="afterclean">after_clean</th>
        </tr>
        <tr>
            <th data-col="prepackage">pre_package
            </th><td data-col="code">N/A</td>
            <td data-col="description">Applicable to Windows 8 and Windows Phone only. This hook is deprecated.</td>
        </tr>
        <tr>
            <th data-col="beforepluginadd">before_plugin_add</th>
            <td data-col="code" rowspan="2"><code>cordova plugin add</code></td>
            <td rowspan="2" data-col="description">To be executed before and after adding a plugin.</td>
        </tr>
        <tr>
            <th data-col="afterpluginadd">after_plugin_add</th>
        </tr>
        <tr>
            <th data-col="beforepluginrm">before_plugin_rm</th>
            <td data-col="code" rowspan="2"><code>cordova plugin rm</code></td>
            <td rowspan="2" data-col="description">To be executed before and after removing a plugin.</td>
        </tr>
        <tr>
            <th data-col="afterpluginrm">after_plugin_rm</th>
        </tr>
        <tr>
            <th data-col="beforepluginls">before_plugin_ls</th>
            <td data-col="code" rowspan="2"><code>cordova plugin ls</code></td>
            <td rowspan="2" data-col="description">To be executed before and after listing the plugins in your application.</td>
        </tr>
        <tr>
            <th data-col="afterpluginls">after_plugin_ls</th>
        </tr>
        <tr>
            <th data-col="beforepluginsearch">before_plugin_search</th>
            <td data-col="code" rowspan="2"><code>cordova plugin search</code></td>
            <td rowspan="2" data-col="description">To be executed before and after a plugin search.</td>
        </tr>
        <tr>
            <th data-col="afterpluginsearch">after_plugin_search</th>
        </tr>
        <tr>
            <th data-col="beforeplugininstall">before_plugin_install</th>
            <td data-col="code" rowspan="2"><code>cordova plugin add</code></td>
            <td rowspan="2" data-col="description">To be executed before and after installing a plugin (to the platforms). Plugin hooks in plugin.xml are executed for a plugin being installed only</td>
        </tr>
        <tr>
            <th data-col="afterplugininstall">after_plugin_install</th>
        </tr>
        <tr>
            <th data-col="beforepluginuninstall">before_plugin_uninstall</th>
            <td data-col="code" rowspan="2"><code>cordova plugin rm</code></td>
            <td data-col="description">To be executed before uninstalling a plugin (from the platforms).Plugin hooks in plugin.xml are executed for a plugin being installed only</td>
        </tr>
    </tbody>
</table>

<!-- END HTML -->

<a class="fragment-anchor" id="ways-to-define-hooks"></a><span id="ways-to-define-hooks"></span><h2>Ways to define hooks<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#ways-to-define-hooks"><i class="glyphicon glyphicon-link"></i></a></h2>

<a class="fragment-anchor" id="configxml"></a><h3>Config.xml<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#configxml"><i class="glyphicon glyphicon-link"></i></a></h3>

<p>Hooks could be defined in project's <code>config.xml</code> using <code>&lt;hook&gt;</code> elements, for example:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/appBeforeBuild.bat"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/appBeforeBuild.js"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_plugin_install"</span> <span class="na">src=</span><span class="s">"scripts/appBeforePluginInstall.js"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;platform</span> <span class="na">name=</span><span class="s">"android"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/wp8/appAndroidBeforeBuild.bat"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/wp8/appAndroidBeforeBuild.js"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_plugin_install"</span> <span class="na">src=</span><span class="s">"scripts/wp8/appWP8BeforePluginInstall.js"</span> <span class="nt">/&gt;</span>
    ...
<span class="nt">&lt;/platform&gt;</span>

<span class="nt">&lt;platform</span> <span class="na">name=</span><span class="s">"windows"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/windows/appWinBeforeBuild.bat"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/windows/appWinBeforeBuild.js"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_plugin_install"</span> <span class="na">src=</span><span class="s">"scripts/windows/appWinBeforePluginInstall.js"</span> <span class="nt">/&gt;</span>
    ...
<span class="nt">&lt;/platform&gt;</span>
</code></pre></div>
<a class="fragment-anchor" id="plugin-hooks-pluginxml"></a><h3>Plugin hooks (plugin.xml)<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#plugin-hooks-pluginxml"><i class="glyphicon glyphicon-link"></i></a></h3>

<p>As a plugin developer you can define hook scripts using <code>&lt;hook&gt;</code> elements in a <code>plugin.xml</code> like that:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_plugin_install"</span> <span class="na">src=</span><span class="s">"scripts/beforeInstall.js"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"after_build"</span> <span class="na">src=</span><span class="s">"scripts/afterBuild.js"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;platform</span> <span class="na">name=</span><span class="s">"android"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_plugin_install"</span> <span class="na">src=</span><span class="s">"scripts/androidBeforeInstall.js"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/androidBeforeBuild.js"</span> <span class="nt">/&gt;</span>
    ...
<span class="nt">&lt;/platform&gt;</span>
</code></pre></div>
<p><code>before_plugin_install</code>, <code>after_plugin_install</code>, <code>before_plugin_uninstall</code> plugin hooks will be fired
exclusively for the plugin being installed/uninstalled.</p>

<a class="fragment-anchor" id="via-hooks-directory-deprecated"></a><h3>Via <code>/hooks</code> directory (Deprecated)<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#via-hooks-directory-deprecated"><i class="glyphicon glyphicon-link"></i></a></h3>

<p>To execute custom action when corresponding hook type is fired, use hook type as a name for a subfolder inside 'hooks' directory and place you script file here, for example:</p>
<div class="highlight"><pre><code class="language-" data-lang=""># script file will be automatically executed after each build
hooks/after_build/after_build_custom_action.js
</code></pre></div>
<p>When using these hooks, they will always be run as executable files, not as loadable JavaScript modules.</p>

<p><strong>Remember</strong>: Make your scripts executable in this case.</p>

<p><strong>Note</strong>: this method is considered deprecated in favor of the hook elements in config.xml and plugin.xml.</p>

<a class="fragment-anchor" id="order-of-hooks-execution"></a><h3>Order of Hooks execution<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#order-of-hooks-execution"><i class="glyphicon glyphicon-link"></i></a></h3>

<a class="fragment-anchor" id="based-on-hooks-definition"></a><h4>Based on Hooks Definition<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#based-on-hooks-definition"><i class="glyphicon glyphicon-link"></i></a></h4>

<p>Hook scripts could be defined by adding them to the special predefined folder
(<code>/hooks</code>) or via configuration files (<code>config.xml</code> and <code>plugin.xml</code>) and run
serially in the following order:</p>

<ul>
<li>Application hooks from <code>/hooks</code>;</li>
<li>Application hooks from <code>config.xml</code>;</li>
<li>Plugin hooks from <code>plugins/.../plugin.xml</code>.</li>
</ul>

<a class="fragment-anchor" id="based-on-the-internal-order-of-execution"></a><h4>Based on the Internal order of execution<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#based-on-the-internal-order-of-execution"><i class="glyphicon glyphicon-link"></i></a></h4>

<p>The internal order of execution of hooks is fixed.</p>

<a class="fragment-anchor" id="example-1-cordova-platform-add"></a><h5>Example 1 (cordova platform add)<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#example-1-cordova-platform-add"><i class="glyphicon glyphicon-link"></i></a></h5>

<p>If there are hooks associated with <code>before_platform_add</code>, <code>after_platform_add</code>, <code>before_prepare</code>, <code>after_prepare</code>,
<code>before_plugin_install</code> and <code>after_plugin_install</code> (and assuming you have one plugin installed on your project),
adding a new platform will execute the hooks in the following order:</p>
<div class="highlight"><pre><code class="language-" data-lang="">before_platform_add
    before_prepare
    after_prepare
    before_plugin_install
    after_plugin_install
after_platform_add
</code></pre></div>
<a class="fragment-anchor" id="example-2-cordova-build"></a><h5>Example 2 (cordova build)<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#example-2-cordova-build"><i class="glyphicon glyphicon-link"></i></a></h5>

<p>If there are hooks associated with <code>before_prepare</code>, <code>after_prepare</code>, <code>before_compile</code>, <code>after_compile</code>, <code>before_build</code>
and <code>after_build</code> - running a build command will execute the hooks in the following order:</p>
<div class="highlight"><pre><code class="language-" data-lang="">before_build
    before_prepare
    after_prepare
    before_compile
    after_compile
after_build
</code></pre></div>
<a class="fragment-anchor" id="script-interface"></a><span id="script-interface"></span><h2>Script Interface<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#script-interface"><i class="glyphicon glyphicon-link"></i></a></h2>

<a class="fragment-anchor" id="windows-quirks"></a><h3>Windows Quirks<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#windows-quirks"><i class="glyphicon glyphicon-link"></i></a></h3>

<p>If you are working on Windows, and in case your hook (Javascript/Non-Javascript)scripts aren't bat files (which is recommended, if you want your scripts to work in non-Windows operating systems) Cordova CLI will expect a shebang line as the first line for it to know the interpreter it needs to use to launch the script. The shebang line should match the following example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">#!/usr/bin/env [name_of_interpreter_executable]
</code></pre></div>
<a class="fragment-anchor" id="javascript"></a><h3>Javascript<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#javascript"><i class="glyphicon glyphicon-link"></i></a></h3>

<p>If you are writing hooks using Node.js you should use the following module definition:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div>
<p><code>context</code> object contains hook type, executed script full path, hook options, command-line arguments passed to Cordova and top-level "cordova" object of the following format:</p>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nt">"hook"</span><span class="p">:</span><span class="w"> </span><span class="s2">"before_plugin_install"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"scriptLocation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c:\\script\\full\\path\\appBeforePluginInstall.js"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cmdLine"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The\\exact\\command\\cordova\\run\\with arguments"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"opts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"projectRoot"</span><span class="p">:</span><span class="s2">"C:\\path\\to\\the\\project"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cordova"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"platforms"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"android"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"plugins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"plugin-withhooks"</span><span class="p">],</span><span class="w">
      </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.21.7-dev"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"plugin"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plugin-withhooks"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pluginInfo"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="err">...</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"platform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"android"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"dir"</span><span class="p">:</span><span class="w"> </span><span class="s2">"C:\\path\\to\\the\\project\\plugins\\plugin-withhooks"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"cordova"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<p><code>context.opts.plugin</code> object will only be passed to plugin hooks scripts.</p>

<p>You can also require additional Cordova modules in your script using <code>context.requireCordovaModule</code> in the following way:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">Q</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">requireCordovaModule</span><span class="p">(</span><span class="s1">'q'</span><span class="p">);</span>
</code></pre></div>
<p>You can make your scipts async using Q:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">Q</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">requireCordovaModule</span><span class="p">(</span><span class="s1">'q'</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">deferral</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Q</span><span class="p">.</span><span class="nx">defer</span><span class="p">();</span>

    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'hook.js&gt;&gt; end'</span><span class="p">);</span>
    <span class="nx">deferral</span><span class="p">.</span><span class="nx">resolve</span><span class="p">();</span>
    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">deferral</span><span class="p">.</span><span class="nx">promise</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p><strong>Note</strong>:  new module loader script interface is used for the <code>.js</code> files defined via <code>config.xml</code> or <code>plugin.xml</code> only.
For compatibility reasons hook files specified via <code>/hooks</code> folders are run via Node child_process spawn, see 'Non-javascript' section below.</p>
</blockquote>

<a class="fragment-anchor" id="non-javascript"></a><h3>Non-javascript<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#non-javascript"><i class="glyphicon glyphicon-link"></i></a></h3>

<p>Non-javascript scripts are run via Node child_process spawn from the project's root directory and have the root directory passes as the first argument. All other options are passed to the script using environment variables:</p>

<table><thead>
<tr>
<th>Environment Variable Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CORDOVA_VERSION</td>
<td>The version of the Cordova-CLI.</td>
</tr>
<tr>
<td>CORDOVA_PLATFORMS</td>
<td>Comma separated list of platforms that the command applies to (e.g: android, ios).</td>
</tr>
<tr>
<td>CORDOVA_PLUGINS</td>
<td>Comma separated list of plugin IDs that the command applies to (e.g: cordova-plugin-file-transfer, cordova-plugin-file).</td>
</tr>
<tr>
<td>CORDOVA_HOOK</td>
<td>Path to the hook that is being executed.</td>
</tr>
<tr>
<td>CORDOVA_CMDLINE</td>
<td>The exact command-line arguments passed to cordova (e.g: cordova run ios --emulate).</td>
</tr>
</tbody></table>

<p>If a script returns a non-zero exit code, then the parent cordova command will be aborted.</p>

<blockquote>
<p><strong>Note</strong>: we highly recommend writing your hooks using Node.js so that they are cross-platform, see <a href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#link-javascript">Javascript</a> section above.</p>
</blockquote>

<a class="fragment-anchor" id="sample-usage"></a><span id="sample-usage"></span><h2>Sample Usage<a class="header-link" href="http://cordova.apache.org/docs/en/6.x/guide/appdev/hooks/index.html#sample-usage"><i class="glyphicon glyphicon-link"></i></a></h2>

<p>This sample demonstrates Cordova hooks usage to trace to the console output the
size of generated .apk file for Android platform.</p>

<p>Create blank Cordova app and add the following definition to <code>config.xml</code> to
tell Cordova to run <code>afterBuild.js</code> script after each platform build.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"after_build"</span> <span class="na">src=</span><span class="s">"scripts/afterBuild.js"</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>Create <code>scripts/afterBuild.js</code> file and add the following implementation.
We use async version of <code>fs.stat</code> method to demonstrate how async functionality
could be done via hooks.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// make sure android platform is part of build</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">platforms</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">'android'</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">requireCordovaModule</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">),</span>
        <span class="nx">path</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">requireCordovaModule</span><span class="p">(</span><span class="s1">'path'</span><span class="p">),</span>
        <span class="nx">deferral</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">requireCordovaModule</span><span class="p">(</span><span class="s1">'q'</span><span class="p">).</span><span class="nx">defer</span><span class="p">();</span>

    <span class="kd">var</span> <span class="nx">platformRoot</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">projectRoot</span><span class="p">,</span> <span class="s1">'platforms/android'</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">apkFileLocation</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">platformRoot</span><span class="p">,</span> <span class="s1">'build/outputs/apk/android-debug.apk'</span><span class="p">);</span>

    <span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span><span class="p">(</span><span class="nx">apkFileLocation</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">stats</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">deferral</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="s1">'Operation failed'</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Size of '</span> <span class="o">+</span> <span class="nx">apkFileLocation</span> <span class="o">+</span> <span class="s1">' is '</span> <span class="o">+</span> <span class="nx">stats</span><span class="p">.</span><span class="nx">size</span> <span class="o">+</span><span class="s1">' bytes'</span><span class="p">);</span>
            <span class="nx">deferral</span><span class="p">.</span><span class="nx">resolve</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">deferral</span><span class="p">.</span><span class="nx">promise</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<p>Parameter <code>ctx</code> in example above is passed by Cordova and represents execution
context such as script full path, target platform, command-line arguments, etc and
also exposes additional helper functionality. See <code>Script Interface</code> section above
for more details.</p>

<p>You can now add android platform and execute build.</p>
<div class="highlight"><pre><code class="language-" data-lang="">cordova platform add android
..
cordova build
..
Size of path\to\app\platforms\android\build\outputs\apk\android-debug.apk is 1821193 bytes
</code></pre></div>
<p>More good usage examples could be found in <a href="http://devgirl.org/2013/11/12/three-hooks-your-cordovaphonegap-project-needs/">Three Hooks Your Cordova Phone Gap Project needs</a></p>


                </div>
            </div>
        </div>
        <div class="row">
            <div class="blue-divider"></div>
<footer>
    <div class="container-fluid">
        <div class="row">
    <div class="col-sm-9">
        <h1>More Resources</h1>
        <div class="row">
            <div class="col-sm-4">
                <h2>General</h2>
                <ul class="nav">
                    <li>
                        <a target="_blank" href="https://projects.apache.org/project.html?cordova">Apache Project Page</a>
                    </li>
                    <li>
                        <a href="https://dist.apache.org/repos/dist/release/cordova/">Source Distribution</a>
                    </li>
                    <li>
                        <a target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">License</a>
                    </li>
                    <li>
                        <a href="http://cordova.apache.org/artwork">Artwork</a>
                    </li>
                </ul>
            </div>
            <div class="col-sm-4">
                <h2>Development</h2>
                <ul class="nav">
                    <li><a target="_blank" href="https://github.com/apache?utf8=%E2%9C%93&amp;query=cordova-">Source Code</a></li>
                    <li><a target="_blank" href="https://issues.apache.org/jira/browse/CB/">Issue Tracker</a></li>
                    <li><a target="_blank" href="http://stackoverflow.com/questions/tagged/cordova">Stack Overflow</a></li>
                    <li><a href="http://cordova.apache.org/contact">Mailing List</a></li>
                </ul>
            </div>
            <div class="col-sm-4">
                <h2>Apache Software Foundation</h2>
                <ul class="nav">
                    <li>
                        <a target="_blank" href="http://www.apache.org/">About ASF</a>
                    </li>
                    <li>
                        <a target="_blank" href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a>
                    </li>
                    <li>
                        <a target="_blank" href="http://www.apache.org/foundation/thanks.html">Thanks</a>
                    </li>
                    <li>
                        <a target="_blank" href="http://www.apache.org/security/">Security</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="col-sm-3">
        <h1>Contribute</h1>
        <p style="padding-top:20px"><strong>Help Cordova move forward!</strong></p>
        <p>Report bugs, improve the docs, or contribute to the code.</p>
        <a href="http://cordova.apache.org/contribute" class="btn btn-lg btn-primary">
            Learn More
        </a>
        <p style="padding-top:20px"> <iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" class="twitter-follow-button twitter-follow-button-rendered" style="position: static; visibility: visible; width: 167px; height: 20px;" title="Twitter Follow Button" src="../common-files/follow_button.6e778523ecf0a9c9f1c446083d86ede1.en.html" data-screen-name="apachecordova"></iframe></p>
    </div>
</div>
<p class="copyright_text">
    Copyright 漏 2012, 2013, 2015 The Apache Software Foundation, Licensed under the <a target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.<br>
    Apache and the Apache feather logos are <a target="_blank" href="http://www.apache.org/foundation/marks/list/">trademarks</a> of The Apache Software Foundation.
    <br>
    "Raleway" font used under license. For details see the <a href="http://cordova.apache.org/attributions/">attributions page</a>.
</p>

    </div>
</footer>

        </div>
    </div>
</div>

</body></html>